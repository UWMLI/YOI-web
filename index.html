<html>
<head>
<title>Notebook</title>
<link rel='stylesheet' type='text/css' href='css.css' />
<link rel="stylesheet" type="text/css" href="https://google-developers.appspot.com/maps/documentation/javascript/examples/default.css" />
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
<script type="text/javascript" src="utils/json2.js"></script>
<script type="text/javascript" src="utils/server-conf.js"></script>
<script type="text/javascript" src="utils/nbutils.js"></script>
<script type="text/javascript" src="views.js"></script>
<script type="text/javascript" src="model.js"></script>
<script type="text/javascript" src="controller.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places"></script>

<script src="utils/jquery-1.10.2.min.js"></script>
<script src="utils/jquery-cookie-master/jquery.cookie.js"></script>

<script type="text/javascript" src="utils/richmarker.js" ></script>
<script type="text/javascript" src="utils/markerclusterer.js"></script>
<script src="utils/recorder.js"></script>
<script type="text/javascript">

window.addEventListener('load', pageLoad, false);

//Defining here to make available to everyone
var model;
var controller;

function pageLoad()
{
    //Initialize stuff
    controller = new Controller();
    model = new Model();
	model.finishLoad(startLoadGame);

    if(navigator.appName == 'Microsoft Internet Explorer') alert('You might need to install quicktime to properly view some media.\n(http://www.apple.com/quicktime/download)');
}

function startLoadGame()
{
    document.getElementById('message').innerHTML = "&nbsp; <img height='12px' src='assets/images/spinner.gif'></img> Waiting on Server...";
	callService("notes.getNotesWithAttributes", finishLoadGame, '', JSON.stringify({ gameId:model.gameId, searchTerms:[], noteCount:50, searchType:0, playerId:0, tagIds:[], lastLocation:0, date:0}));
}


function finishLoadGame(responseText)
{
    model.gameJSONText = responseText;
    responseData=JSON.parse(responseText);
    if(responseData.returnCode == 1) //Error
    {
        document.getElementById('message').innerHTML = responseData.data;	
        return;
    }
    model.populateFromData(responseData.data);

    document.getElementById('message').innerHTML = "";

    controller.populateAllFromModel();

    //  Set actual page visible
    document.getElementById('message').style.display = 'none';
    document.getElementById('content').style.display = 'block';

    google.maps.event.trigger(model.views.gmap, 'resize'); // To fix google maps incorrect sizing bug

}

</script>
</head>
<body id='body'>
<div id='message'></div>

<div id='header'>
	<h1>Sifter</h1>
	<ul>
		<li class='tabs' id='ImagesTab' onclick="Javascript:controller.showImagesAsTab()" >Images </li>
		<li class='tabs selectedTab' id='MapTab'onclick="Javascript:controller.showMapAsTab()">Map </li>
	</ul>
</div>


<div id= 'content'>

<!-- Main View -->
<div id='main_view_full' >
    	<div id='main_view_left' class='behindView'  ></div>
    <div id='main_view_right' >

        <div id='main_view_map' class='selectedView' >

	</div>
        <div id='main_view_info'>
            Tags:<br />
            <input id="tag1" value="Innovation"          type="checkbox" checked="checked" onchange="controller.populateAllFromModel()">Innovation         </input><br />
            <input id="tag2" value="Stories of the Past" type="checkbox" checked="checked" onchange="controller.populateAllFromModel()">Stories of the Past</input><br />
            <input id="tag3" value="Madison Culture"     type="checkbox" checked="checked" onchange="controller.populateAllFromModel()">Madison Culture    </input><br />
            <input id="tag4" value="Must Do"             type="checkbox" checked="checked" onchange="controller.populateAllFromModel()">Must Do            </input><br />
            <input id="tag5" value="100 Years from Now"  type="checkbox" checked="checked" onchange="controller.populateAllFromModel()">100 Years from Now </input><br />
            <br />
            <span>Search:<input id="filterbox" type="text" onchange="controller.populateListNotesFromModel()"/></span>
            <br /><br /><br />
            
        	<button onClick="JavaScript:controller.showLoginView()" class = "button" id="loginButton" >Login to Upload</button> <!-- CDH displays before login -->
			<button onClick="JavaScript:controller.createNote()" class="button" id="uploadButton" >Upload</button> <!--CDH Only displays after login -->
			<button onClick="JavaScript:controller.logout()" class="button" id="logoutButton" >Log Out</button> 
		</div>
    </div>
</div> <!-- end main view full -->

<!-- a thing with position absolute in the top left corner that takes up the full size of the screen. now popups can position themselves within this without guessing percentages -->
	<div id='darkBackgroundLayer'        class='darkBackgroundLayer'> <!--for dimming the background when popups have the focus CDH -->
    <div id='note_view_container'        class='container'></div>
    <div id='create_note_view_container' class='container'></div>
    <div id='login_view_container'       class='container'></div>
    <div id='join_view_container'        class='container'></div>
</div>

<!-- HTML CONSTRUCTIONS OF REUSABLE NODES -->
<!-- These will never be seen. This is simply an area to construct nodes in raw html rather than dealing with doing so in javascript. From here, nodes can be accessed by their ID's, cloned, and renamed. -->
<div id='constructs'>

<!-- Close Buttons (?) --><!-- NOT re-used. Just put here so they don't show up, I guess? -->
<div id='note_view_close_button'        class='close_button'>X</div>
<div id='create_note_view_close_button' class='close_button'>X</div>
<div id='login_view_close_button'       class='close_button'>X</div>
<div id='join_view_close_button'        class='close_button'>X</div>

<!-- Create Note View -->
<div id='note_create_view_construct' class='note_create_view'>
    <div id='note_create_view_left_construct' class='note_create_view_left'>
        <div id='note_create_view_image_construct' class='note_create_view_image' style="border:0px single transparent" >
            <br />Image: (jpg, gif or png) <br />
            <img width=300 height=300 id="imageThumbnail" />
            <input type="file" id="imageFileInput" onchange="handleImageFileSelect(this.files)" style="display:none;" accept="image/gif, image/jpeg, image/png";  />
            <button id="browseImage" class="button" onclick="clickBrowseImage()">Browse</button>
            <button id="showCamera" onclick="showVideo()" class="button">Camera</button>
            <video id="video" width="200" height="200" autoplay class="hidden"></video>
            <button id="snap" class="button hidden">Snap Photo</button>
            <canvas id="canvas" width="200" height="200" style="display:none;"></canvas>
        </div>
        <div id='note_create_view_location_construct' class='note_create_view_location'>
            <br />Location:<br />
            <div id="mapCanvas" style="width:300px;height:300px;border:1px solid black;"></div><br />
            <input type="text" name="location" id="searchTextField" style="width:300px" /><br />
            <div id="latitude"></div>
            <div id="longitude"></div>
            <div id="address"></div>
            <br /><br />
        </div>
    </div>
    <div id='note_create_view_right_construct' class='note_create_view_right'>
        <div id='note_create_view_caption_construct' class='note_create_view_caption'>
            <br />Caption:<br /><textarea id="caption" rows="8" ></textarea> 
        </div>
        <div id='note_create_view_tags_construct' class='note_create_view_tags'>
            <div id='note_create_view_tags_construct' class='note_create_view_tags'>
                Tags:<br />
                <input id="create_tag_1" name="note_tag_select" value="Innovation"          type="radio">Innovation</input><br />
                <input id="create_tag_2" name="note_tag_select" value="Stories of the Past" type="radio">Stories of the Past</input><br />
                <input id="create_tag_3" name="note_tag_select" value="Madison Culture"     type="radio">Madison Culture</input><br />
                <input id="create_tag_4" name="note_tag_select" value="Must Do"             type="radio">Must Do</input><br />
                <input id="create_tag_5" name="note_tag_select" value="100 Years from Now"  type="radio">100 Years from Now</input><br />
                <br />
            </div>
            <div id='note_create_view_audio_construct' class='note_create_view_audio'>
                Audio: (mp3, aac, m4a or caf)<br />
                <button id="browseAudio" class="button" onclick="clickBrowseAudio()">Browse</button><br />
                <input type="file" id="audioFileInput" onchange="handleAudioFileSelect(this.files)" class="hidden" accept="audio/caf, audio/mp3, audio/aac, audio/m4a"; />
             <!--
				 <button id="recordAudio" onclick="recordAudio()" class="button">Record</button>
                <button class="hidden button" id="startRecording" onclick="startRecording(this);">start</button>
                <button id="stopRecording" onclick="stopRecording(this);" class="hidden button" disabled>stop</button>
            --> 
			   <br />Preview:<br />
                <audio controls id="audioPreview"><source type="audio/ogg"><source type="audio/mpeg">Your browser does not support the audio element.</audio>
                <br /><br />
            </div>
        </div>
        <div id='note_create_view_submit_construct' class='note_create_view_submit'>
            <br />
            <button id="submitNote" onclick="submitNote()" class="button">Submit</button>
            <button id="cancelNote" onclick="cancelNote()" class="button">Cancel</button>
        </div>
    </div>
</div>

<!-- Login View -->
<div id='login_view_construct' class='login_view'>
    <div id='login_view_top_construct' class='login_view_top'>
        <br />To upload content, you must login.<br />
        <hr style="background:#F87431; border:0; height:7px" /><br /><br />
    </div>
    <div id='login_view_bottom_construct' class='login_view_bottom'>
        <ul>
            <li>
                <label for="usermail_login">Username</label>
                <input type="text" id="usermail_login" placeholder="username" required>
            </li>
            <li>
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="password" required></li>
            <li>
                <button id="login" class="button" onclick="clickLogin()">Login</button>
            </li>
        </ul>
        <br /><span id="noAccount" onClick="clickNoAccount()" class="internalLink">Don\'t have an account?</span>
        <br /><span id="forgotPassword" onClick="clickForgotPassword()" class="internalLink">Forgot Password?</span>
    </div>
</div>

<!-- Join View -->
<div id='join_view_construct' class='join_view'>
    <div id='join_view_top_construct' class='join_view_top'>
        Join to contribute<br/>
        <hr style="background:#F87431; border:0; height:7px" /><br/>
    </div>
    <div id='join_view_bottom_construct' class='join_view_bottom'>
        <ul>
            <li>
                <label for="usermail_join">Email</label>
                <input type="text" id="usermail_join" placeholder="Email" required>
            </li> 
            
		<!-- CDH Added in username -->
            <li> 
                <label for="username_join">Username</label>
                <input type="text" id="username_join" placeholder="username" required>
            </li> 
            <li>
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="password" required>
            </li>
            <li>
                <button id="signUp" class="button" onclick="clickSignUp()">Sign Up</button>
            </li>
        </ul>
        <br/> Already have an account?
        <span id="viewLoginPage" onClick="clickViewLoginPage()" class="internalLink">Log in</span>
    </div>
</div>

<!-- Note View -->
<div id='note_view_construct' class='note_view'>
    <div id='note_view_left_construct' class='note_view_left'></div>
    <div id='note_view_right_construct' class='note_view_right'>
        <div id='note_view_caption_construct' class='note_view_captions'></div>
        <div id='note_view_audio_construct' class='note_view_audio'></div>
        <div id='note_view_tags_construct' class='note_view_tags'></div>
        <div id='note_view_comments_construct' class='note_view_comments'></div>
        <div id='note_view_input_construct' class='note_view_input'></div>
    </div>
</div>

<!-- Note Content Cell -->
<div id='note_content_cell_construct' class='note_content_cell'></div>

<!-- Note Comment Cell -->
	<div id='note_comment_cell_construct' class='note_comment_cell'>
		<div id='note_comment_cell_header_construct' class='note_comment_cell_header note_view_owner'></div>
	</div>

</div>


</body>
</html>
